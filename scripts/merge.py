# add the boundary code to the data from data.json.
# data.json example:
	# {
	# 	"Type": "Person and Vehicle search",
	# 	"Date": "2021-05-31T23:00:00+00:00",
	# 	"Part of a policing operation": "False",
	# 	"Policing operation": "",
	# 	"Latitude": 51.484282,
	# 	"Longitude": -0.106707,
	# 	"Gender": "Male",
	# 	"Age range": "18-24",
	# 	"Self-defined ethnicity": "White - English/Welsh/Scottish/Northern Irish/British",
	# 	"Officer-defined ethnicity": "White",
	# 	"Legislation": "Misuse of Drugs Act 1971 (section 23)",
	# 	"Object of search": "Controlled drugs",
	# 	"Outcome": "Arrest",
	# 	"Outcome linked to object of search": "",
	# 	"Removal of more than just outer clothing": ""
	# },
# boundary example:
# { "type": "Feature", "properties": { "LAD13CD": "E06000001", "LAD13CDO": "00EB", "LAD13NM": "Hartlepool", "LAD13NMW": null }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ -1.241956526315958, 54.722452909315834 ], [ -1.242505189342398, 54.722420389946741 ], [ -1.24192061729046, 54.722713302903806 ], [ -1.241956526315958, 54.722452909315834 ] ] ], [ [ [ -1.270237428346303, 54.727158414465499 ], [ -1.268210325997062, 54.72608036652354 ], [ -1.267390512992676, 54.726854573664205 ], [ -1.265882373803238, 54.726620785048247 ], [ -1.264695411850965, 54.725971937199624 ], [ -1.263208539118907, 54.726451796693183 ], [ -1.260565163468531, 54.725719461950817 ], [ -1.258546933685663, 54.726045045500641 ], [ -1.25882250176557, 54.725408666041631 ], [ -1.257430512310725, 54.725536751549427 ], [ -1.255399410730049, 54.721564707750275 ], [ -1.253721558021485, 54.720357350566282 ], [ -1.251850550010507, 54.719612498494953 ], [ -1.248751495556522, 54.720722986007928 ], [ -1.247599540915856, 54.722399976361984 ], [ -1.245782110752467, 54.722282643701391 ], [ -1.244005303060669, 54.721567912904128 ], [ -1.242825023970778, 54.722253434697549 ], [ -1.2392641871449, 54.721384592823249 ], [ -1.227282984173657, 54.715604899830346 ], [ -1.219577460493303, 54.712686953327349 ], [ -1.217702973805294, 54.711528152206469 ], [ -1.215006511942233, 54.711064978840092 ], [ -1.209951251982901, 54.708905855879479 ], [ -1.202457277661393, 54.706169722930014 ], [ -1.194412973675085, 54.704160101227252 ], [ -1.187318827991314, 54.701778864778198 ], [ -1.183144676891514, 54.701075899338058 ], [ -1.177759430767014, 54.699265483757543 ], [ -1.175231964218854, 54.696575609365198 ], [ -1.177036354036534, 54.694893837233174 ], [ -1.17396638930484, 54.691812913335795 ], [ -1.177002770811895, 54.694636583474775 ], [ -1.178009674056891, 54.694100604665216 ], [ -1.181639933117572, 54.69318692945928 ], [ -1.182898134364215, 54.693651951083424 ], [ -1.184875949900315, 54.693280624906194 ], [ -1.183089100729721, 54.693877012108842 ], [ -1.183561610728138, 54.694529948711313 ], [ -1.185256429483062, 54.695043718199848 ], [ -1.186919164832876, 54.695146546964757 ], [ -1.190210513571358, 54.696755662502142 ], [ -1.18983432673777, 54.697024553823518 ], [ -1.186518711495696, 54.696395736914006 ], [ -1.185799643521427, 54.69751517211504 ], [ -1.188328282995471, 54.698084821067013 ], [ -1.192760329286392, 54.700480660383171 ], [ -1.196314633364357, 54.698554115641585 ], [ -1.195017425846665, 54.697692653520832 ], [ -1.194706699653664, 54.697791243376258 ], [ -1.193725119879861, 54.696664952147827 ], [ -1.194271688838052, 54.697662536727599 ], [ -1.192731358073722, 54.697327863617936 ], [ -1.191092482295279, 54.696020130508863 ], [ -1.190468406478865, 54.696037533738277 ], [ -1.190693963177532, 54.694604729543819 ], [ -1.187494887559017, 54.693898530250202 ], [ -1.189365165525893, 54.694250754972536 ], [ -1.195925223207175, 54.692350572177638 ], [ -1.196064266337568, 54.691516610706344 ], [ -1.194330456943083, 54.690387129658156 ], [ -1.192626537683681, 54.68853797061972 ], [ -1.194368642210008, 54.690260667991069 ], [ -1.194819051970528, 54.68937215878578 ], [ -1.194785252986287, 54.690531245661646 ], [ -1.196159290771265, 54.691418384821375 ], [ -1.19629611568473, 54.692031300252957 ], [ -1.196957638983659, 54.692157007053964 ], [ -1.197867710325623, 54.69179456864191 ], [ -1.198410558112366, 54.689990892310185 ], [ -1.197847938024954, 54.689807432837796 ], [ -1.19795301334317, 54.68904154476111 ], [ -1.196585751120776, 54.688677508566329 ], [ -1.19544638958581, 54.689027631586242 ], [ -1.19859191233108, 54.687242097137386 ], [ -1.198664255090897, 54.686246825539705 ], [ -1.197570354043596, 54.686026599895762 ], [ -1.196097771420496, 54.686366434588514 ], [ -1.194649857399017, 54.687496365075681 ], [ -1.194662032313117, 54.688213601607451 ], [ -1.194066815559175, 54.688189874896601 ], [ -1.19433119492299, 54.687372924386381 ], [ -1.195520162286094, 54.686394955787271 ], [ -1.196836032448701, 54.685900413704971 ], [ -1.198420772338638, 54.685771605525396 ], [ -1.198839688154778, 54.685372659737851 ], [ -1.199110447530051, 54.680757869711712 ], [ -1.198474236087679, 54.679513469477584 ], [ -1.198222750231849, 54.678344404970943 ], [ -1.196512535283557, 54.675887737847248 ], [ -1.190253888987142, 54.670411687846773 ], [ -1.187386596598622, 54.664131290937405 ], [ -1.184785999756196, 54.660679010721083 ], [ -1.17609258699173, 54.653617571471223 ], [ -1.16474643073838, 54.647594103094434 ], [ -1.162188954405947, 54.647615090551682 ], [ -1.157786096576368, 54.648369132028897 ], [ -1.157709365880035, 54.648182567801314 ], [ -1.159283770302724, 54.647888842697562 ], [ -1.160968389609321, 54.646681882782715 ], [ -1.16309162860799, 54.646221154694793 ], [ -1.163773905032062, 54.646351683309327 ], [ -1.162108075802195, 54.646800309401129 ], [ -1.163875659444333, 54.647056966009551 ], [ -1.167733146874415, 54.646436460062041 ], [ -1.16878446997599, 54.644277811215865 ], [ -1.167511678076309, 54.639526632742808 ], [ -1.165564570357815, 54.637685280954329 ], [ -1.162184499275254, 54.635922068227316 ], [ -1.161784437425302, 54.635411534659163 ], [ -1.164792641987028, 54.636568268824348 ], [ -1.165346139918281, 54.637229932404288 ], [ -1.166374437568703, 54.637252290196678 ], [ -1.166081070520402, 54.637051658357912 ], [ -1.166961106031239, 54.636595780439585 ], [ -1.166685809264004, 54.635890204365317 ], [ -1.164791329593285, 54.634363745801231 ], [ -1.165910416309097, 54.633882562248459 ], [ -1.165563987440323, 54.633702233749332 ], [ -1.16418068518334, 54.634073747360695 ], [ -1.164760081181938, 54.634603483618932 ], [ -1.16405182360259, 54.635145008966504 ], [ -1.163240152019261, 54.634383597711754 ], [ -1.160410344178171, 54.635180939126109 ], [ -1.160863405900353, 54.634771574092731 ], [ -1.163892624225591, 54.633767099834756 ], [ -1.164747787718096, 54.632103211332861 ], [ -1.165576813319836, 54.631864477511932 ], [ -1.166866847489704, 54.632262493949511 ], [ -1.167552605852688, 54.632894501643484 ], [ -1.169463053069687, 54.633182616655859 ], [ -1.173994584624434, 54.633325936005143 ], [ -1.175981675411347, 54.633121083830893 ], [ -1.176807837836012, 54.632331350316818 ], [ -1.176876554105435, 54.632917770074741 ], [ -1.177605093928774, 54.633126722932303 ], [ -1.181832602598246, 54.633290152208794 ], [ -1.184153640869571, 54.633271654446496 ], [ -1.185338654253981, 54.632966881304327 ], [ -1.186514793117406, 54.633105994787833 ], [ -1.186846150803667, 54.632803560078003 ], [ -1.188595639658824, 54.632701155338978 ], [ -1.190622675500376, 54.631883417563337 ], [ -1.190378223782187, 54.631243707241609 ], [ -1.19218927188983, 54.630375969943458 ], [ -1.200729510892624, 54.623013849812075 ], [ -1.20358775217638, 54.622896971772235 ], [ -1.209949217558574, 54.621905124398253 ], [ -1.211877213451122, 54.621994972002923 ], [ -1.212355294242578, 54.62226050188039 ], [ -1.212778133350299, 54.622740460038628 ], [ -1.213719115112177, 54.622775329990496 ], [ -1.213958209175286, 54.623387997302608 ], [ -1.213548801679526, 54.623575864241516 ], [ -1.213923503484458, 54.623661875390006 ], [ -1.214578480865846, 54.623670617419258 ], [ -1.213848039410087, 54.623077231077033 ], [ -1.214095185378954, 54.622870336518261 ], [ -1.215823256488833, 54.623694858517169 ], [ -1.2182885412226, 54.623312668882988 ], [ -1.219613614799747, 54.623510838095321 ], [ -1.21963461016934, 54.624841946326129 ], [ -1.220600787643751, 54.625344248209466 ], [ -1.221692259429453, 54.625288356876624 ], [ -1.22361970609185, 54.624033560416805 ], [ -1.224415447150393, 54.625355250999903 ], [ -1.222290242622471, 54.625769406288043 ], [ -1.222286543497998, 54.626207048652518 ], [ -1.223062275862166, 54.626546342101136 ], [ -1.224349958642464, 54.626436864391565 ], [ -1.225247292747885, 54.625676017078433 ], [ -1.226102567680881, 54.625579032426053 ], [ -1.225902318984755, 54.626581598768723 ], [ -1.226531194630932, 54.626989131087413 ], [ -1.227393896953752, 54.626991940145771 ], [ -1.229158709394354, 54.626305793275584 ], [ -1.229605193962587, 54.62513673144705 ], [ -1.230124607147379, 54.626420678059361 ], [ -1.230865870306757, 54.626455942402067 ], [ -1.232035858452943, 54.625850453295669 ], [ -1.233215998678441, 54.627668804500331 ], [ -1.233058910121929, 54.628444284586237 ], [ -1.23407169840349, 54.629034845292544 ], [ -1.234260774671669, 54.629772073448208 ], [ -1.233490409813815, 54.62996311763024 ], [ -1.233100182360433, 54.631109182696051 ], [ -1.236039195773708, 54.631915010039123 ], [ -1.235935125295303, 54.633665913089295 ], [ -1.236209797550596, 54.631904402669321 ], [ -1.238286848563917, 54.632750571211382 ], [ -1.236948404463304, 54.631921638742604 ], [ -1.233418580883148, 54.631147145703125 ], [ -1.233276064632931, 54.630900000881475 ], [ -1.233770620084887, 54.630549043260515 ], [ -1.233644277745126, 54.630100693021362 ], [ -1.234474763213757, 54.629925305625569 ], [ -1.23428306427109, 54.628997537475755 ], [ -1.23903818181224, 54.627936481671348 ], [ -1.237446569164023, 54.626489456767658 ], [ -1.238889192076696, 54.626458087742385 ], [ -1.240372384040721, 54.625495905703019 ], [ -1.24072226900862, 54.624755775290431 ], [ -1.241626825259597, 54.625253927571421 ], [ -1.24565556891226, 54.626083415402199 ], [ -1.247393339700293, 54.625937327736324 ], [ -1.250369380285856, 54.625296660033897 ], [ -1.254068924906659, 54.626858963273875 ], [ -1.253817556745954, 54.627475718109729 ], [ -1.254254774934888, 54.626860107491311 ], [ -1.250768975230502, 54.625297334718887 ], [ -1.252444815782108, 54.623947061355722 ], [ -1.254018454548825, 54.624114034053676 ], [ -1.255594749739892, 54.62337242050171 ], [ -1.256675701899955, 54.623378159539612 ], [ -1.257619063900953, 54.624050777150828 ], [ -1.256190591033009, 54.625604847318201 ], [ -1.258701288290702, 54.626458720257538 ], [ -1.259828912252937, 54.624580151206139 ], [ -1.262114122304027, 54.624885269821597 ], [ -1.263890547031493, 54.624290356311931 ], [ -1.266780118941227, 54.624147912547492 ], [ -1.267430984539751, 54.624558959355276 ], [ -1.267598071541292, 54.626035627513055 ], [ -1.268502261167045, 54.625624096054601 ], [ -1.268938403801567, 54.626351077186385 ], [ -1.271902951505675, 54.62531296430511 ], [ -1.276151884502454, 54.627297581421061 ], [ -1.279181576892844, 54.628175696464602 ], [ -1.285970051897543, 54.627682971816498 ], [ -1.286257873681728, 54.628230175010067 ], [ -1.291032963132551, 54.627005434532094 ], [ -1.292401518980359, 54.628741623249702 ], [ -1.296184288932306, 54.628015945656273 ], [ -1.29901769447865, 54.627995526897301 ], [ -1.29857440760478, 54.63053356576966 ], [ -1.298796824739139, 54.633453806213367 ], [ -1.298169849018626, 54.635498295166897 ], [ -1.302796266995649, 54.635748780071403 ], [ -1.304345829203214, 54.636684237821889 ], [ -1.307001958114754, 54.63696547153836 ], [ -1.308405287699396, 54.638264010107143 ], [ -1.308245122031965, 54.638572245449524 ], [ -1.31187422351208, 54.640929505508836 ], [ -1.311939361332198, 54.641201279868675 ], [ -1.311227891850097, 54.641217008873525 ], [ -1.311484539357735, 54.641892485139188 ], [ -1.315222211489741, 54.643442337113278 ], [ -1.315561309825845, 54.643918761098789 ], [ -1.31503634660712, 54.644082951017602 ], [ -1.316349845651759, 54.645223616161289 ], [ -1.317164466359973, 54.644789648965144 ], [ -1.31798558938843, 54.645262490432671 ], [ -1.320695865156802, 54.644983843046148 ], [ -1.322014154239307, 54.644543678976589 ], [ -1.326146716730865, 54.645117626818092 ], [ -1.32665773031574, 54.644388934771868 ], [ -1.327898752069116, 54.644494680252215 ], [ -1.32864009699121, 54.644173464540899 ], [ -1.329496656560166, 54.643064731791824 ], [ -1.329039268449255, 54.638468999277322 ], [ -1.329494350652631, 54.636516868349609 ], [ -1.33195621455642, 54.633677126560869 ], [ -1.33504217965347, 54.63130178943431 ], [ -1.337494724135718, 54.63490369384661 ], [ -1.33965202583211, 54.636194305597414 ], [ -1.342807492259478, 54.636699450044219 ], [ -1.34988215896957, 54.638798308603079 ], [ -1.354665330289048, 54.638095940388354 ], [ -1.356813115147779, 54.638365283765879 ], [ -1.361918873002737, 54.640402642415324 ], [ -1.365172813202398, 54.642383364767909 ], [ -1.368001324085792, 54.643539482055779 ], [ -1.37435710695105, 54.643771073358373 ], [ -1.379389963930747, 54.643268526039797 ], [ -1.380884877436341, 54.64390615171294 ], [ -1.381295824777238, 54.644293786750254 ], [ -1.382681320527783, 54.644384430460896 ], [ -1.38375048398611, 54.646232177361945 ], [ -1.378891755872705, 54.646168728458761 ], [ -1.374500439920486, 54.646547854166243 ], [ -1.368953374877482, 54.647802418822245 ], [ -1.366512283355426, 54.648818678014635 ], [ -1.36486657754328, 54.648412844820989 ], [ -1.362655924741986, 54.649153438770533 ], [ -1.359291278007288, 54.64945652750594 ], [ -1.358022117558402, 54.648564604781221 ], [ -1.3562819375344, 54.648651533059244 ], [ -1.355824313830372, 54.648287829361408 ], [ -1.352712650467376, 54.648958744021542 ], [ -1.349783616745238, 54.648570108578724 ], [ -1.349882720399715, 54.650712210677675 ], [ -1.348728860410963, 54.650858791908945 ], [ -1.347865202631775, 54.650593528305663 ], [ -1.345826250416092, 54.650748796064796 ], [ -1.344037836000608, 54.650647462788562 ], [ -1.343125334054608, 54.650241705719473 ], [ -1.34120838010049, 54.650232198549482 ], [ -1.341883491271938, 54.652188713446144 ], [ -1.341295956905279, 54.653251363876763 ], [ -1.343443690328499, 54.655684079506536 ], [ -1.343130477210692, 54.657517499242175 ], [ -1.344913458472992, 54.658457289434274 ], [ -1.345416759498219, 54.65829465062059 ], [ -1.347498752674161, 54.658572787098052 ], [ -1.346306213333408, 54.659279917202909 ], [ -1.346384954063582, 54.659975924390949 ], [ -1.34599551078481, 54.660094247395385 ], [ -1.34643503202476, 54.660719407202663 ], [ -1.347069445388292, 54.660889083312981 ], [ -1.346335596380478, 54.661119684582971 ], [ -1.346410173555014, 54.661495737173553 ], [ -1.347837247621672, 54.662410197496847 ], [ -1.346629538742242, 54.66299323048348 ], [ -1.346571163165837, 54.664022808620324 ], [ -1.346032376427877, 54.66446025833239 ], [ -1.343514519091965, 54.665139533154651 ], [ -1.343363088372512, 54.665781272474192 ], [ -1.342257106565326, 54.666103295795537 ], [ -1.343515935309062, 54.668610260478609 ], [ -1.3406996037336, 54.668744156211716 ], [ -1.340187287735009, 54.669262605499632 ], [ -1.338073686968699, 54.669562925416535 ], [ -1.335693315710218, 54.671291553766416 ], [ -1.334309894416879, 54.671213866850444 ], [ -1.333024308883326, 54.672641998894058 ], [ -1.332378299213272, 54.675441438476113 ], [ -1.333442813846254, 54.677198831146256 ], [ -1.331903440792079, 54.677445583256997 ], [ -1.331835981614256, 54.68117744360385 ], [ -1.330885861269508, 54.681233313734538 ], [ -1.330931720252356, 54.682123263109567 ], [ -1.331331297551732, 54.683669404902943 ], [ -1.332092444418662, 54.683884791063448 ], [ -1.331636336824937, 54.685117966048388 ], [ -1.332115240234218, 54.686843379400393 ], [ -1.334426337119841, 54.689036291237322 ], [ -1.338659116051401, 54.68945936685531 ], [ -1.344644013997659, 54.690808432261477 ], [ -1.344462195168178, 54.691116595601734 ], [ -1.333009339216471, 54.69201122867922 ], [ -1.332175113652136, 54.690189502380129 ], [ -1.329810682490855, 54.689542885005864 ], [ -1.327540376162015, 54.691371713723278 ], [ -1.32596778023451, 54.691154487266381 ], [ -1.319481005760326, 54.691278217486953 ], [ -1.319729876528663, 54.692723796490299 ], [ -1.319372858822309, 54.693291557351841 ], [ -1.315362599819778, 54.694568473848285 ], [ -1.312682352635666, 54.695902232147816 ], [ -1.313494187755639, 54.697075117946497 ], [ -1.3142320642323, 54.697943825274116 ], [ -1.312820930903314, 54.698720385407071 ], [ -1.313835485356069, 54.701217275856806 ], [ -1.309337452482986, 54.701553908201433 ], [ -1.309301593352503, 54.702477548473773 ], [ -1.307768065757708, 54.702771659477484 ], [ -1.306217382604125, 54.703797179657485 ], [ -1.30639563607732, 54.703991415863712 ], [ -1.304105622354182, 54.704323389375837 ], [ -1.304202718326231, 54.70563242655529 ], [ -1.303201259070796, 54.70565992742825 ], [ -1.303797199158237, 54.707653928933667 ], [ -1.301312705861656, 54.708090777833441 ], [ -1.302004604252203, 54.709012315465557 ], [ -1.301546624455813, 54.710194139911671 ], [ -1.302724592616181, 54.711736763633134 ], [ -1.304123237291003, 54.712634490657031 ], [ -1.303610791092956, 54.7131006602336 ], [ -1.305504208081987, 54.715206340612447 ], [ -1.304605838292197, 54.716634586962634 ], [ -1.305506736234514, 54.717511468188619 ], [ -1.303659595557948, 54.71849751248488 ], [ -1.303201350791994, 54.717880183915511 ], [ -1.303223610391571, 54.718121157898544 ], [ -1.301765831050483, 54.718216122321223 ], [ -1.299305164890274, 54.719123077833288 ], [ -1.294896110364071, 54.71939948180232 ], [ -1.292179609122025, 54.718581137406936 ], [ -1.290287488615679, 54.718387647985118 ], [ -1.285520173115087, 54.72041134469093 ], [ -1.282695648992371, 54.722113848290995 ], [ -1.282344527690213, 54.72300685665671 ], [ -1.281201944395496, 54.723000090737727 ], [ -1.277924463519057, 54.723784941943457 ], [ -1.276512793567409, 54.724414592661631 ], [ -1.275616919193864, 54.725459802761613 ], [ -1.274891711255064, 54.725204737724518 ], [ -1.272495505675996, 54.72540247762462 ], [ -1.270237428346303, 54.727158414465499 ] ] ] ] } },

import json
from turfpy.measurement import boolean_point_in_polygon
from geojson import Point, MultiPolygon, Feature

print("opening file data.json...")
f = open("../src/assets/data.json", encoding="utf-8")

# returns JSON object as a dictionary
data = json.load(f)
print("loaded file successfully")

print("opening file eng_lad.json...")
f = open("../src/assets/eng_lad.json", encoding="utf-8")

# returns JSON object as a dictionary
data_boundaries = json.load(f)
print("loaded file successfully")

for indx, elm in enumerate(data):
    print("processing element " + str(indx) + "...")
    # skip elements without coordinates
    if (elm["Longitude"] == "" or elm["Latitude"] == ""):
        continue
    point = Point((elm["Longitude"], elm["Latitude"]))
    for boundary in data_boundaries["features"]:
        if boolean_point_in_polygon(point, boundary["geometry"]):
            elm["lad_name"] = boundary["properties"]["LAD13NM"]
            elm["lad_id"] = boundary["properties"]["LAD13CD"]
            break

print("start writing data_boundaries.json...")
with open("data_boundaries.json", "w", encoding="utf-8") as outfile:
    json.dump(data, outfile, ensure_ascii=False)
print("finished writing data_boundaries.json 🎉")


# Closing file
f.close()
